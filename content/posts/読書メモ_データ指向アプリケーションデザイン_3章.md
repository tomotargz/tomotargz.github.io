---
title: "読書メモ_データ指向アプリケーションデザイン_3章"
date: 2023-02-07T22:03:52+09:00
draft: true
tags:
  - "book"
---

[データ指向アプリケーションデザイン](https://www.oreilly.co.jp/books/9784873118703/)の3章を読んだ。

<!--more-->

# データベースが利用しているデータ構造

## ハッシュインデックス

ハッシュインデックスでは、複数のセグメントに分割したログとしてデータを管理する。
各セグメントは、キーからそのキーを持つ最新のデータの位置を検索できるハッシュテーブルを持つ。

書き込み時は、書き込み用のセグメントにデータを追記し、ハッシュテーブルを更新する。
書き込み用のセグメントがある一定サイズを超えた場合はファイルをクローズして、新しくセグメントを作成する。そして作成したセグメントを新しい書き込み用のセグメントとする。

読み込み時は、探しているキーを持つデータが見つかるまで、新しいセグメントから順にハッシュテーブルを検索する。

バックグラウンドプロセスとして、クローズ済みのセグメントに対してコンパクションとマージを行う。コンパクションはセグメントを圧縮する処理のことで、セグメント内にキーが重複しているデータがあれば、最新のものを残してほかを削除する。マージは名前のとおり2つのセグメントを1つにまとめる。

## SSTableとLSMツリー

## Bツリー
